# Story 2.2: Update All Documentation

## Status
Draft

## Story
**As a** developer,
**I want** all documentation updated to reflect the current stack,
**so that** documentation is accurate and doesn't reference outdated services.

## Acceptance Criteria
1. [ ] Remove all references to AWS S3 from documentation
2. [ ] Remove all references to Upstash (Redis & Vector) from documentation
3. [ ] Remove all references to Render.com from documentation
4. [ ] Update technology stack sections to reflect Cloudflare services
5. [ ] Update environment configuration docs for Cloudflare
6. [ ] Archive outdated deployment guides
7. [ ] Update README.md with current stack information
8. [ ] Ensure setup guides reflect current configuration

## Tasks / Subtasks
- [ ] Task 1: Audit and update architecture documentation (AC: 1, 2, 3, 4)
  - [ ] Review and update `docs/architecture/tech-stack.md`
  - [ ] Review and update `docs/architecture/technology-stack.md`
  - [ ] Review and update `docs/architecture/architecture-overview.md`
  - [ ] Review and update `docs/architecture/core-components.md`
  - [ ] Review and update `docs/architecture/data-flow-and-integration.md`
  - [ ] Review and update `docs/architecture/integration-points.md`
  - [ ] Remove references to AWS S3, replace with Cloudflare R2
  - [ ] Remove references to Upstash Redis, replace with Cloudflare KV
  - [ ] Remove references to Upstash Vector, replace with Cloudflare Vectorize
  - [ ] Remove references to Render.com, replace with Cloudflare Workers/Containers

- [ ] Task 2: Update deployment and operations documentation (AC: 3, 4, 5, 6)
  - [ ] Archive `docs/DEPLOYMENT.md` to `docs/ARCHIVE/`
  - [ ] Archive `docs/DEPLOYMENT_GUIDE.md` to `docs/ARCHIVE/`
  - [ ] Archive `docs/PRODUCTION_DEPLOYMENT.md` to `docs/ARCHIVE/`
  - [ ] Create new `docs/CLOUDFLARE_DEPLOYMENT.md` with current deployment process
  - [ ] Update `docs/operations/deployment-checklist.md` for Cloudflare
  - [ ] Update `docs/DEPLOYMENT_CHECKLIST.md` for Cloudflare
  - [ ] Remove Render-specific deployment configurations

- [ ] Task 3: Update environment and setup documentation (AC: 5, 8)
  - [ ] Update `docs/ENVIRONMENT_SETUP.md` with Cloudflare env variables
  - [ ] Update `docs/setup/environment.md` to remove AWS/Upstash variables
  - [ ] Update `docs/setup/complete-setup.md` with Cloudflare setup
  - [ ] Update `docs/setup/github-secrets.md` for Cloudflare CI/CD
  - [ ] Update `.env.example` to reflect current variables
  - [ ] Document new Cloudflare environment variables:
    - CLOUDFLARE_KV_NAMESPACE_ID
    - CLOUDFLARE_VECTORIZE_INDEX
    - CLOUDFLARE_R2_BUCKET
    - CLOUDFLARE_ACCOUNT_ID
    - CLOUDFLARE_API_TOKEN

- [ ] Task 4: Update PRD and requirements documentation (AC: 1, 2, 3, 4)
  - [ ] Update `docs/prd.md` tech stack section
  - [ ] Update `docs/prd/technical-constraints.md`
  - [ ] Update `docs/prd/non-functional-requirements.md`
  - [ ] Update `docs/prd/functional-requirements.md`
  - [ ] Update `docs/prd/assumptions-and-dependencies.md`
  - [ ] Mark Epic 1 (Cloudflare Migration) as complete in PRD

- [ ] Task 5: Update project README and main documentation (AC: 7, 8)
  - [ ] Update root `README.md` with current tech stack
  - [ ] Update quick start guide to use Cloudflare
  - [ ] Update local development instructions
  - [ ] Add Cloudflare dashboard links section
  - [ ] Update troubleshooting section for Cloudflare

- [ ] Task 6: Clean up memory configuration documentation (AC: 1, 2)
  - [ ] Update `docs/operations/memory-configuration/*.md` files
  - [ ] Remove Upstash Vector references from mem0 docs
  - [ ] Update to use Cloudflare Vectorize for vector storage
  - [ ] Ensure graph memory docs reflect current implementation

- [ ] Task 7: Archive migration-related documentation (AC: 6)
  - [ ] Move completed migration guides to archive:
    - `docs/CF_MIGRATION_GUIDE.md` → `docs/ARCHIVE/`
    - `docs/operations/cloudflare-migration.md` → `docs/ARCHIVE/`
  - [ ] Keep as reference but mark as completed

- [ ] Task 8: Final documentation validation (AC: 8)
  - [ ] Run grep to ensure no remaining AWS/Upstash/Render references
  - [ ] Verify all environment variables documented
  - [ ] Test setup instructions on fresh environment
  - [ ] Ensure all links and references are updated

## Dev Notes

### Previous Story Context
Story 2.1 (Cleanup Test Artifacts) is 95% complete but blocked on Python 3.9 compatibility issues. This documentation update story can proceed independently as it doesn't require running tests.

### Current Stack References to Update
Based on grep analysis, 67 documentation files contain references to the old stack (AWS, Upstash, Render) that need updating.

### Technology Stack Changes
[Source: Current Implementation]
**FROM (Old Stack):**
- **Storage**: AWS S3
- **Cache**: Upstash Redis
- **Vector DB**: Upstash Vector
- **Hosting**: Render.com
- **Database**: Supabase (unchanged)

**TO (New Stack):**
- **Storage**: Cloudflare R2
- **Cache**: Cloudflare KV
- **Vector DB**: Cloudflare Vectorize
- **Hosting**: Cloudflare Workers/Containers
- **Database**: Supabase (unchanged)

### Documentation Structure
[Source: architecture/source-tree.md]
```
docs/
├── architecture/         # Architecture documentation (needs updating)
├── operations/          # Operational guides (needs updating)
├── prd/                 # Product requirements (needs updating)
├── setup/              # Setup guides (needs updating)
├── stories/            # User stories (keep as-is)
├── technical/          # Technical specs (needs review)
└── ARCHIVE/            # Archived docs (move outdated here)
```

### Environment Variables to Document
**Remove:**
- AWS_ACCESS_KEY_ID
- AWS_SECRET_ACCESS_KEY
- AWS_REGION
- S3_BUCKET_NAME
- UPSTASH_REDIS_REST_URL
- UPSTASH_REDIS_REST_TOKEN
- UPSTASH_VECTOR_REST_URL
- UPSTASH_VECTOR_REST_TOKEN
- RENDER_SERVICE_NAME

**Add:**
- CLOUDFLARE_ACCOUNT_ID
- CLOUDFLARE_API_TOKEN
- CLOUDFLARE_KV_NAMESPACE_ID
- CLOUDFLARE_VECTORIZE_INDEX
- CLOUDFLARE_R2_BUCKET
- CLOUDFLARE_R2_ACCESS_KEY_ID
- CLOUDFLARE_R2_SECRET_ACCESS_KEY
- CLOUDFLARE_R2_ENDPOINT

### Files Known to Need Major Updates
Priority files with heavy old-stack references:
1. `docs/architecture/tech-stack.md`
2. `docs/architecture/technology-stack.md`
3. `docs/ENVIRONMENT_SETUP.md`
4. `docs/DEPLOYMENT_CHECKLIST.md`
5. `docs/PRODUCTION_DEPLOYMENT.md`
6. `docs/setup/environment.md`
7. `docs/setup/github-secrets.md`
8. Root `README.md`

### Documentation Standards
[Source: architecture/coding-standards.md#documentation]
- Use clear, concise language
- Include code examples where applicable
- Maintain consistent formatting
- Keep documentation up-to-date with code changes
- Use Markdown for all documentation
- Include last-updated dates in documentation

### Search Commands for Validation
```bash
# Find remaining AWS references
grep -r "AWS\|S3_BUCKET" docs/ --include="*.md"

# Find remaining Upstash references  
grep -r "Upstash\|UPSTASH" docs/ --include="*.md"

# Find remaining Render references
grep -r "Render\|RENDER" docs/ --include="*.md"

# Verify Cloudflare references added
grep -r "Cloudflare" docs/ --include="*.md"
```

## Testing
[Source: Documentation validation process]

**Documentation Review Checklist:**
```bash
# Verify no broken links
find docs -name "*.md" -exec grep -l "](/" {} \;

# Check for outdated references
grep -r "AWS\|Upstash\|Render" docs/ --include="*.md" | grep -v ARCHIVE

# Verify environment variables documented
grep -r "CLOUDFLARE_" .env.example

# Test setup instructions
# Follow docs/setup/complete-setup.md on fresh environment
```

**Documentation Locations to Verify:**
- Architecture docs: `docs/architecture/*.md`
- Setup guides: `docs/setup/*.md`
- Deployment docs: `docs/CLOUDFLARE_DEPLOYMENT.md` (new)
- Environment config: `.env.example`
- Main README: `README.md`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-27 | 1.0 | Initial story draft created | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
_To be populated by development agent_

### Debug Log References
_To be populated during development_

### Completion Notes List
_To be populated during development_

### File List
_To be populated during development - expected ~30-40 files modified_

## QA Results
_To be populated by QA agent after implementation_