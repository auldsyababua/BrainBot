id: no-hardcoded-secrets
language: python
message: "Potential hardcoded secret or API key detected. Use environment variables instead."
rule:
  any:
    - pattern: |
        $KEY = "$SECRET"
      constraints:
        KEY:
          regex: "(?i)(api_key|api_secret|secret_key|password|token|auth|credential)"
        SECRET:
          regex: "^[a-zA-Z0-9_\\-]{20,}$"
    
    - pattern: |
        $DICT = {
          $$$BEFORE,
          "$KEY": "$SECRET",
          $$$AFTER
        }
      constraints:
        KEY:
          regex: "(?i)(api_key|api_secret|secret_key|password|token|auth|credential)"
        SECRET:
          regex: "^[a-zA-Z0-9_\\-]{20,}$"

fix: |
  # Use environment variables
  import os
  $KEY = os.getenv("$KEY")